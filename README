# üì¶ API CEP ‚Äî Cache inteligente da ViaCEP

Uma API simples, por√©m eficiente, desenvolvida para consultar e armazenar em cache os dados fornecidos pelo servi√ßo p√∫blico [ViaCEP](https://viacep.com.br).  
O objetivo √© reduzir o n√∫mero de requisi√ß√µes externas, melhorar a performance e otimizar o consumo de recursos, especialmente em aplica√ß√µes que realizam buscas frequentes por CEPs.

---

## üß© Resumo do projeto

A **API CEP** foi criada com base na ideia de minimizar lat√™ncia e carga sobre a API p√∫blica, oferecendo uma camada intermedi√°ria que:

-  Consulta o **ViaCEP** apenas quando necess√°rio.
-  **Armazena em cache** as respostas por um tempo configur√°vel.
-  Entrega dados de forma imediata nas requisi√ß√µes subsequentes.

---

## ‚öôÔ∏è Requisitos

Antes de executar o projeto, √© necess√°rio ter instalado:

-  [Node.js](https://nodejs.org) (vers√£o **22.18.0** ou superior recomendada)
-  [npm](https://www.npmjs.com/) ou [yarn](https://yarnpkg.com/)

Al√©m disso, utilize o arquivo **`.envexample`** como modelo para criar seu pr√≥prio arquivo **`.env`**, definindo vari√°veis de ambiente como:

-  Porta do servidor (`PORT`)
-  Token de autentica√ß√£o (`AUTH_TOKEN`)
-  Tempo de cache (`CACHE_TTL`)

Essas vari√°veis permitem ajustar facilmente o comportamento da aplica√ß√£o conforme o ambiente (desenvolvimento, teste ou produ√ß√£o).

---

## üßæ Vers√µes utilizadas

As vers√µes recomendadas s√£o as mesmas usadas durante o desenvolvimento e testes do projeto:

```bash
node --version
v22.18.0

npm --version
10.9.3
```

> ‚ö†Ô∏è √â altamente recomendado manter as mesmas vers√µes para evitar conflitos de depend√™ncias e comportamento inesperado de bibliotecas.

---

## üöÄ Instala√ß√£o do projeto

Clone o reposit√≥rio e instale as depend√™ncias:

```bash
git clone https://github.com/danielguirra/desafio-node.git
cd desafio-node
npm install
```

Isso instalar√° automaticamente todas as bibliotecas necess√°rias, incluindo o Express, m√≥dulos de cache e utilit√°rios para manipula√ß√£o de requisi√ß√µes HTTP.

---

## üõ†Ô∏è Build do projeto

Antes de executar, √© necess√°rio gerar os arquivos compilados do TypeScript:

```bash
npm run build
```

O comando acima compila todos os arquivos `.ts` da pasta `src/` e gera a vers√£o em JavaScript dentro do diret√≥rio `dist/`.

---

## ‚ñ∂Ô∏è Execu√ß√£o da aplica√ß√£o

Ap√≥s o build, execute o servidor:

```bash
npm run start
```

A API ser√° iniciada (por padr√£o) na porta `3000`, e voc√™ poder√° realizar requisi√ß√µes via **HTTP**.
Se quiser alterar a porta, basta ajustar a vari√°vel `PORT` no arquivo `.env`.

Exemplo de log de inicializa√ß√£o:

```
üöÄ Servidor iniciado em http://localhost:3000
üíæ Cache ativo: TTL = 5 minutos
üîí Token configurado: ativo
```

---

## üß† Exemplo de requisi√ß√£o

Use **cURL** ou qualquer cliente HTTP (como Postman, Insomnia ou HTTPie) para testar:

```bash
curl --location --request POST 'http://localhost:3000/cep/14407-411' \
--header 'Authorization: Bearer tokensuperseguro12314'
```

**Resposta esperada (JSON):**

```json
{
   "cep": "14407-411",
   "logradouro": "Rua Manoel Cust√≥dio da Silveira",
   "complemento": "at√© 898/899",
   "unidade": "",
   "bairro": "Jardim Vera Cruz III",
   "localidade": "Franca",
   "uf": "SP",
   "estado": "S√£o Paulo",
   "regiao": "Sudeste",
   "ibge": "3516200",
   "gia": "3104",
   "ddd": "16",
   "siafi": "6425",
   "cached": false
}
```

> üîÅ A primeira requisi√ß√£o realiza a consulta real no ViaCEP.
> As pr√≥ximas s√£o servidas instantaneamente a partir do cache, com o campo `"cached": true`.

---

## üìö Estrutura do projeto

A estrutura b√°sica da aplica√ß√£o segue o padr√£o:

```
.
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ server.ts        # Inicializa√ß√£o do servidor e rotas principais
‚îÇ   ‚îú‚îÄ‚îÄ cache.ts         # Configura√ß√£o e controle de cache
‚îÇ   ‚îî‚îÄ‚îÄ routes/
‚îÇ       ‚îî‚îÄ‚îÄ cep.routes.ts # Rota principal de busca por CEP
‚îú‚îÄ‚îÄ dist/                # C√≥digo compilado (build)
‚îú‚îÄ‚îÄ .envexample          # Exemplo de vari√°veis de ambiente
‚îú‚îÄ‚îÄ package.json
‚îî‚îÄ‚îÄ tsconfig.json
```

Essa estrutura facilita a manuten√ß√£o e a escalabilidade, permitindo adicionar novas rotas e funcionalidades sem comprometer o n√∫cleo do projeto.

---

## üß© Tecnologias e bibliotecas utilizadas

-  **TypeScript** ‚Äî tipagem est√°tica e maior seguran√ßa no c√≥digo.
-  **Express.js** ‚Äî framework web r√°pido e minimalista.
-  **node-fetch / axios** ‚Äî consumo da API ViaCEP.
-  **apicache** ‚Äî sistema de cache simples e eficiente.
-  **dotenv** ‚Äî carregamento seguro das vari√°veis de ambiente.

Essas ferramentas tornam o projeto robusto, de f√°cil leitura e altamente extens√≠vel.

---

## üß∞ Testes e valida√ß√£o

Para validar o funcionamento do cache, basta:

1. Fazer uma requisi√ß√£o para um CEP v√°lido.
2. Repetir a mesma requisi√ß√£o dentro do per√≠odo configurado no cache.
3. Verificar no cabe√ßalho ou corpo da resposta se o cache foi utilizado (`cached: true`).

Caso o tempo de cache expire, a API far√° uma nova consulta no ViaCEP e atualizar√° os dados automaticamente.

---

## üßæ Logs e monitoramento

Durante a execu√ß√£o, a aplica√ß√£o registra logs informativos, incluindo:

-  CEPs consultados
-  Origem dos dados (cache ou API externa)
-  Tempo de resposta
-  Erros de autentica√ß√£o ou formata√ß√£o

Esses logs s√£o √∫teis para auditoria, otimiza√ß√£o de desempenho e depura√ß√£o.

---

## üìÑ Licen√ßa

Este projeto est√° licenciado sob a [MIT License](https://choosealicense.com/licenses/mit/).
Voc√™ pode us√°-lo, modific√°-lo e distribu√≠-lo livremente, desde que mantenha os cr√©ditos originais.

---

## üë®‚Äçüíª Autor

**Daniel Guirra**
üìß [daniel.guirra777@gmail.com](mailto:daniel.guirra777@gmail.com)
üîó [GitHub](https://github.com/danielguirra)
üíº [LinkedIn](https://www.linkedin.com/in/daniel-guirra-ba4202331/)

> Projeto desenvolvido com foco em simplicidade, desempenho e aprendizado cont√≠nuo.
